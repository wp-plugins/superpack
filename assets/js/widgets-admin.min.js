!function(a,b){"use strict";a(document).ready(function(){var c,d=a(".sp-media__select"),e=a(".sp-media__clear");d.live("click",function(d){d.preventDefault();var e=a(this).data("button-text")?a(this).data("button-text"):"Select",f=a(this).data("title")?a(this).data("title"):"",g=a(this).data("filter")?a(this).data("filter"):"",h=a(this).data("multiple")?!0:!1,i=a(this).parents(".uploader"),j=i.find("input"),k=function(a){var b="";return _.each(a,function(a){"image"===g&&(b+="<img ",b+=' src="'+a.url+'" ',b+=h?' width="106" ':"",b+=">")}),b};"undefined"!=typeof c&&c.close(),c=b.media.frames.media_frame=b.media({title:f,button:{text:e},library:{type:g},multiple:h}),c.on("open",function(){var a,d=c.state().get("selection"),e=j.val();e&&(e=e.split(","),e.forEach(function(c){a=b.media.attachment(c),d.add(a?[a]:[])}))}),c.on("select",function(){var a=c.state().get("selection"),b=[],d=[];a.map(function(a){a=a.toJSON(),d.push(a),b.push(a.id)}),i.find(".image-preview").html(k(d)),i.find(".sp-media__clear").show(),j.val(b),j.trigger("change")}),c.open()}),e.live("click",function(){a(this).parents(".uploader").find("input").val(""),a(this).parents(".uploader").find("input").change(),a(this).parents(".uploader").find(".image-preview").html(""),a(this).hide()})})}(jQuery,wp);